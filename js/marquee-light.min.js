function init(e){const t=e.querySelector(".marquee"),n=e.querySelector(".marquee-track"),o=e.querySelector("[data-content-source]"),s=e.querySelector(".toggle-marquee-btn"),a=parseFloat(e.getAttribute("data-speed"))||.5,r=e.getAttribute("data-gap"),i="false"===e.getAttribute("data-fade");r&&e.style.setProperty("--marquee-gap",r),i&&t.classList.add("no-fade");let d,u,l=!1,c=!1,m=!1,f=0,y=0;s.addEventListener("click",function(){c=!c,t.classList.toggle("paused",c),s.innerHTML=c?"Play":"Stop",toggleButton.title=isPaused?"Play marquee":"Stop marquee"}),t.addEventListener("mouseenter",()=>{m=!0}),t.addEventListener("mouseleave",()=>{m=!1});const p=e=>{l=!0,c||(c=!0,t.classList.add("paused"),s.innerHTML="Play",s.title="Play marquee"),n.style.transition="none";const o=window.getComputedStyle(n),a=new DOMMatrixReadOnly(o.transform);f=a.m41,d=e.touches?e.touches[0].clientX:e.clientX,e.preventDefault()},v=e=>{if(!l)return;const t=(e.touches?e.touches[0].clientX:e.clientX)-d;n.style.transform=`translateX(${f+t}px)`},L=()=>{if(!l)return;l=!1;const e=window.getComputedStyle(n),t=new DOMMatrixReadOnly(e.transform);f=t.m41,n.style.transition="transform 0.3s ease-out",f>0?(f-=y,n.style.transition="none",n.style.transform=`translateX(${f}px)`,setTimeout(()=>n.style.transition="transform 0.3s ease-out",50)):f<-y&&(f+=y,n.style.transition="none",n.style.transform=`translateX(${f}px)`,setTimeout(()=>n.style.transition="transform 0.3s ease-out",50))};t.addEventListener("mousedown",p),t.addEventListener("touchstart",p),window.addEventListener("mousemove",v),window.addEventListener("touchmove",v),window.addEventListener("mouseup",L),window.addEventListener("touchend",L),function(){const e=t.offsetWidth;let s=o.offsetWidth;for(;s<3*e;){const e=o.cloneNode(!0);e.removeAttribute("data-content-source"),n.appendChild(e),s+=e.offsetWidth}const a=n.offsetWidth,r=n.cloneNode(!0);r.querySelector("[data-content-source]")?.removeAttribute("data-content-source"),n.appendChild(r),y=a/2}(),function e(){c||m||l||(f+=a,f>0&&(f-=y),n.style.transform=`translateX(${f}px)`),u=requestAnimationFrame(e)}()}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".marquee-instance").forEach(init)});